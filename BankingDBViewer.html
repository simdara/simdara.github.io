
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	
	 <script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js'></script>
	<meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>
      Cambodian Banking Database Viewer Ver. 1.2
    </title>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google.charts.load('current', {packages: ['controls']});
    </script>
    <script type="text/javascript">
	// Define global variables
	var data;
	var table;
	var filteredDT;
	var YearArr;
	var NameArr;
	var ColHeader;
	var perFormatter;
	// Global variables for Chart8
	var data_ch
	var colToShow
	var isLess
	var xID = [44,29,48]; //Loan Size, PortYield, OperatingExp/GLP
	var yID = [29,48,32,33]; // PortYield, OperatingExp/GLP, ROE, ROIC
	var format_hAxis = ['decimal','percent','percent'];
	var format_vAxis = ['percent','percent','percent','percent'];
	//
function drawCharts() {
    var query = new google.visualization.Query('http://spreadsheets.google.com/tq?key=1UgM52SB6iu7ucnDVQn3O3M7IH716QBxQ50eoY_IIEq8&gid=0&range=B2:BU112');
	//
    query.send(handleQueryResponse);
}

function handleQueryResponse(response) {
    if (response.isError()) {
        alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
        return;
    }

    data = response.getDataTable();
	// Filter for License
    var filterLicense = new google.visualization.ControlWrapper({ 
        containerId: 'filterLicense_div',
        controlType: 'CategoryFilter',
        options: {
            filterColumnLabel: 'License',
            ui: {
				'labelStacking':'vertical',
				'label':'NBC License',
				'allowTyping': false
            },
        },
		state:{'selectedValues':['MDI']}
	});
	// Filter for Name of Companies
	var filterName = new google.visualization.ControlWrapper({
        containerId: 'filterName_div',
        controlType: 'CategoryFilter',
        options: {
            filterColumnLabel: 'Name',
            ui: {
				'labelStacking':'vertical',
				'label':'Institutions',
				'allowTyping': false
            },
        },
		//state:{'selectedValues':['First Finance','Tomato']}
	});
	// Filter for Year
    var filterYear = new google.visualization.ControlWrapper({
        containerId: 'filterYear_div',
        controlType: 'NumberRangeFilter',
        options: {
            filterColumnLabel: 'Year',
            ui: {
				'labelStacking':'vertical',
				'lable':'Year',
				'format': {'pattern':'####'}
            },
        },
		state: {'lowValue':2011}
	});

	// Creat a table
	table = new google.visualization.ChartWrapper({
		containerId:'table_div',
		chartType:'Table',
		dataTable:data,
		options:{'width':'0px','height':'0px'}
	});
	// Table 'ready' event
	google.visualization.events.addListener(table,'ready',reDrawCharts);
	// define dashboard and establish dependencies
    var dashboard = new google.visualization.Dashboard(document.querySelector('#dashboard'));
    dashboard.bind([filterLicense],[filterName]);
	dashboard.bind([filterLicense],[filterYear]);
	dashboard.bind([filterName],[filterYear]);
	dashboard.bind([filterLicense,filterName,filterYear], [table]);
    dashboard.draw(data);

}

google.charts.load('current', {packages:['controls','corechart'], callback: drawCharts});

function reDrawCharts(){
	// Get filtered datatable from ChartWraper
	filteredDT = table.getDataTable();
	YearArr	= filteredDT.getDistinctValues(2);//
	NameArr	= filteredDT.getDistinctValues(0);
	perFormatter = new google.visualization.NumberFormat({pattern:'0.00%'});
	//
	ColHeader = [];
	for (var n=0;n<NameArr.length;n++) {
		ColHeader.push({label:NameArr[n],type:'number'});
	}
	ColHeader.unshift('Year');	
	// Selected option for BSIS Items
	var BSISitem_SelectedID = document.getElementById("BSISitem").selectedIndex;
	var BSISitem_SelectedText = document.getElementById("BSISitem").options[BSISitem_SelectedID].text;
	// Selected option for Profitability Ratios
	var Profit_SelectedID = document.getElementById("ProfitabilityRatios").selectedIndex;
	var Profit_SelectedText = document.getElementById("ProfitabilityRatios").options[Profit_SelectedID].text; 
	// Selected option for Default Risk Ratios
	var Default_SelectedID = document.getElementById("DefaultRatios").selectedIndex;
	var Default_SelectedText = document.getElementById("DefaultRatios").options[Default_SelectedID].text; 
	// Selected option for Funding Cost Ratios
	var FC_SelectedID = document.getElementById("FundingCostRatios").selectedIndex;
	var FC_SelectedText = document.getElementById("FundingCostRatios").options[FC_SelectedID].text; 
	// Selected option for Leverage Ratios
	var Lev_SelectedID = document.getElementById("LevRatios").selectedIndex;
	var Lev_SelectedText = document.getElementById("LevRatios").options[Lev_SelectedID].text; 
	// Define Data Array for Chart
	var dataforChart1 = [ColHeader];
	var dataforChart2 = [ColHeader];
	var dataforChart3 = [ColHeader];
	var dataforChart4 = [ColHeader];
	var dataforChart6 = [ColHeader];
	var dataforChart7 = [ColHeader];
		for (var i=0; i<YearArr.length;i++) {
			var Rowi1 = [];
			var Rowi2 = [];
			var Rowi3 = [];
			var Rowi4 = [];
			var Rowi6 = [];
			var Rowi7 = [];
			for (var j=0; j<NameArr.length;j++) {
				var rIndx = filteredDT.getFilteredRows([{column:0,value: NameArr[j]},{column:2,value: YearArr[i]}]);
				if (rIndx[0]==null) {
					Rowi1.push(null); Rowi2.push(null);Rowi3.push(null); Rowi4.push(null); Rowi6.push(null); Rowi7.push(null);
					} else {
					Rowi1.push(filteredDT.getValue(rIndx[0],BSISitem_SelectedID+3));
					Rowi2.push(filteredDT.getValue(rIndx[0],BSISitem_SelectedID+16));
					Rowi3.push(filteredDT.getValue(rIndx[0],Profit_SelectedID+29));
					Rowi4.push(filteredDT.getValue(rIndx[0],Default_SelectedID+34));
					Rowi6.push(filteredDT.getValue(rIndx[0],FC_SelectedID+65));
					Rowi7.push(filteredDT.getValue(rIndx[0],Lev_SelectedID+56));
				};
			}
			
			Rowi1.unshift(YearArr[i].toFixed(0));
			Rowi2.unshift(YearArr[i].toFixed(0));
			Rowi3.unshift(YearArr[i].toFixed(0));
			Rowi4.unshift(YearArr[i].toFixed(0));
			Rowi6.unshift(YearArr[i].toFixed(0));
			Rowi7.unshift(YearArr[i].toFixed(0));
			//
			dataforChart1[i+1] = Rowi1;
			dataforChart2[i+1] = Rowi2;
			dataforChart3[i+1] = Rowi3;
			dataforChart4[i+1] = Rowi4;
			dataforChart6[i+1] = Rowi6;
			dataforChart7[i+1] = Rowi7;
	
		}
	// Define DataTable for Chart
	var DTforChart1 = new google.visualization.arrayToDataTable(dataforChart1);
	var DTforChart2 = new google.visualization.arrayToDataTable(dataforChart2);
	var DTforChart3 = new google.visualization.arrayToDataTable(dataforChart3);
	var DTforChart4 = new google.visualization.arrayToDataTable(dataforChart4);
	var DTforChart6 = new google.visualization.arrayToDataTable(dataforChart6);
	var DTforChart7 = new google.visualization.arrayToDataTable(dataforChart7);
	// Formatting columns
	for (var i=1;i<=NameArr.length;i++) {
		perFormatter.format(DTforChart2,i);
		perFormatter.format(DTforChart3,i);
		perFormatter.format(DTforChart4,i);
		perFormatter.format(DTforChart6,i);
		perFormatter.format(DTforChart7,i);
	};
	// Draw Charts
	var chart1 = new google.visualization.ChartWrapper({
	containerId: 'chart1_div',
	chartType: 'ColumnChart',
	dataTable: DTforChart1,
	options: {
		title: BSISitem_SelectedText+' (USD)',
		vAxis:{format:'short'},
		legend: {position: 'bottom'},
	}
	});
	var chart2 = new google.visualization.ChartWrapper({
	containerId: 'chart2_div',
	chartType: 'LineChart',
	dataTable: DTforChart2,
	options: {
		title:BSISitem_SelectedText+' (% Change YoY)',
		vAxis:{format:'percent'},
		legend: {position: 'bottom'},
	}
	});
	var chart3 = new google.visualization.ChartWrapper({
	containerId: 'chart3_div',
	chartType: 'LineChart',
	dataTable: DTforChart3,
	options: {
		title:Profit_SelectedText,
		vAxis:{format:'percent'},
		pointSize:5,
		legend: {position: 'bottom'},
	}
	});
	var chart4 = new google.visualization.ChartWrapper({
	containerId: 'chart4_div',
	chartType: 'LineChart',
	dataTable: DTforChart4,
	options: {
		title:Default_SelectedText,
		vAxis:{format:'percent'},
		pointSize:7,
		pointShape:'diamond',
		lineDashStyle:[4,4],
		legend: {position: 'bottom'},
	}
	});
	chart1.draw();
	chart2.draw();
	chart3.draw();
	chart4.draw();
	// 4. Breakdown Portfolio Yield
	constrYearOptions();
	reDrawChart5();
	// 5. Funding cost 
	var chart6 = new google.visualization.ChartWrapper({
	containerId: 'chart6_div',
	chartType: 'LineChart',
	dataTable: DTforChart6,
	options: {
		title:FC_SelectedText,
		vAxis:{format:'percent'},
		pointSize:6,
		pointShape:'square',
		lineDashStyle:[4,4],
		legend: {position: 'bottom'},
	}
	});
	chart6.draw();
	// 6. Leverage
	var chart7 = new google.visualization.ChartWrapper({
	containerId: 'chart7_div',
	chartType: 'LineChart',
	dataTable: DTforChart7,
	options: {
		title:Lev_SelectedText,
		vAxis:{format:'percent'},
		pointSize:6,
		pointShape:'diamond',
		//lineDashStyle:[4,4],
		legend: {position: 'bottom'},
	}
	});
	chart7.draw();
	// 7. Scatter Chart
	drawChart8();
}
function reDrawChart12(){
	//
	var BSISitem_SelectedID = document.getElementById("BSISitem").selectedIndex;
	var BSISitem_SelectedText = document.getElementById("BSISitem").options[BSISitem_SelectedID].text;
	
	// Define Data Array for Chart
	var dataforChart1 = [ColHeader];
	var dataforChart2 = [ColHeader];
		for (var i=0; i<YearArr.length;i++) {
			var Rowi1 = [];
			var Rowi2 = [];
			for (var j=0; j<NameArr.length;j++) {
				var rIndx = filteredDT.getFilteredRows([{column:0,value: NameArr[j]},{column:2,value: YearArr[i]}]);
				if (rIndx[0]==null) {Rowi1.push(null); Rowi2.push(null)} else {
					Rowi1.push(filteredDT.getValue(rIndx[0],BSISitem_SelectedID+3));
					Rowi2.push(filteredDT.getValue(rIndx[0],BSISitem_SelectedID+16))
				};
			}
			Rowi1.unshift(YearArr[i].toFixed(0));
			Rowi2.unshift(YearArr[i].toFixed(0));
			dataforChart1[i+1] = Rowi1;
			dataforChart2[i+1] = Rowi2;
		}
	// Define DataTable for Chart
	var DTforChart1 = new google.visualization.arrayToDataTable(dataforChart1);
	var DTforChart2 = new google.visualization.arrayToDataTable(dataforChart2);
	// Formatting columns
	for (var i=1;i<=NameArr.length;i++) {
		perFormatter.format(DTforChart2,i);
	};
	// Draw Charts
	var chart1 = new google.visualization.ChartWrapper({
	containerId: 'chart1_div',
	chartType: 'ColumnChart',
	dataTable: DTforChart1,
	options: {
		title: BSISitem_SelectedText+' (USD)',
		vAxis:{format:'short'},
		legend: {position: 'bottom'},
	}
	});
	var chart2 = new google.visualization.ChartWrapper({
	containerId: 'chart2_div',
	chartType: 'LineChart',
	dataTable: DTforChart2,
	options: {
		title:BSISitem_SelectedText+' (% Change YoY)',
		vAxis:{format:'percent'},
		legend: {position: 'bottom'},
	}
	});
	chart1.draw();
	chart2.draw();
}
function reDrawChart3(){
	// Selected option for Profitability Ratios
	var Profit_SelectedID = document.getElementById("ProfitabilityRatios").selectedIndex;
	var Profit_SelectedText = document.getElementById("ProfitabilityRatios").options[Profit_SelectedID].text; 
	// Define Data Array for Chart
	var dataforChart3 = [ColHeader];
		for (var i=0; i<YearArr.length;i++) {
			var Rowi3 = [];
			for (var j=0; j<NameArr.length;j++) {
				var rIndx = filteredDT.getFilteredRows([{column:0,value: NameArr[j]},{column:2,value: YearArr[i]}]);
				if (rIndx[0]==null) {Rowi3.push(null);} else {
					Rowi3.push(filteredDT.getValue(rIndx[0],Profit_SelectedID+29));
				};
			}
			Rowi3.unshift(YearArr[i].toFixed(0));
			dataforChart3[i+1] = Rowi3;
		}
	// Define DataTable for Chart
	var DTforChart3 = new google.visualization.arrayToDataTable(dataforChart3);
	// Formatting columns
	for (var i=1;i<=NameArr.length;i++) {
		perFormatter.format(DTforChart3,i);
	};
	// Draw Chart
	var chart3 = new google.visualization.ChartWrapper({
	containerId: 'chart3_div',
	chartType: 'LineChart',//'BarChart',
	dataTable: DTforChart3,
	options: {
		title:Profit_SelectedText,
		vAxis:{format:'percent'},
		pointSize:5,
		legend: {position: 'bottom'},
	}
	});
	chart3.draw();
}
function reDrawChart4(){
	// Selected option for Profitability Ratios
	var Default_SelectedID = document.getElementById("DefaultRatios").selectedIndex;
	var Default_SelectedText = document.getElementById("DefaultRatios").options[Default_SelectedID].text; 
	// Define Data Array for Chart
	var dataforChart4 = [ColHeader];
		for (var i=0; i<YearArr.length;i++) {
			var Rowi4 = [];
			for (var j=0; j<NameArr.length;j++) {
				var rIndx = filteredDT.getFilteredRows([{column:0,value: NameArr[j]},{column:2,value: YearArr[i]}]);
				if (rIndx[0]==null) {Rowi4.push(null);} else {
					Rowi4.push(filteredDT.getValue(rIndx[0],Default_SelectedID+34));
				};
			}
			Rowi4.unshift(YearArr[i].toFixed(0));
			dataforChart4[i+1] = Rowi4;
		}
	// Define DataTable for Chart
	var DTforChart4 = new google.visualization.arrayToDataTable(dataforChart4);
	// Formatting columns
	for (var i=1;i<=NameArr.length;i++) {
		perFormatter.format(DTforChart4,i);
	};
	// Draw Chart
	var chart4 = new google.visualization.ChartWrapper({
	containerId: 'chart4_div',
	chartType: 'LineChart',
	dataTable: DTforChart4,
	options: {
		title:Default_SelectedText,
		vAxis:{format:'percent'},
		pointSize:7,
		pointShape:'diamond',
		lineDashStyle:[4,4],
		legend: {position: 'bottom'},
	}
	});
	chart4.draw();
}
function constrYearOptions(){
	var YearOption = document.forms[3].PortYield;
	YearOption.length=0;
	for (var y=0;y<YearArr.length;y++) {
		YearOption[y]= new Option(YearArr[y],YearArr[y],false,false);
	}
	YearOption[YearArr.length-1] = new Option(YearArr[YearArr.length-1],YearArr[YearArr.length-1],false,true);
}
function reDrawChart5(){
	// Selected option for Breakdown of Portfolio Yield
	var PYield_SelectedID = document.getElementById("PortYield").selectedIndex;
	var PYield_SelectedVal = YearArr[PYield_SelectedID]; 
	var PYield_Selectedtext = document.getElementById("PortYield").options[PYield_SelectedID].text;
	//
	var view5 = new google.visualization.DataView(filteredDT);
	view5.setRows(view5.getFilteredRows([{column: 2, value: PYield_SelectedVal}]));
	view5.setColumns([0,68,69,70,71]);
	if (NameArr.length==1) {
		dtPie = new google.visualization.DataTable();
		dtPie.addColumn('string','Ratio');
		dtPie.addColumn('number',view5.getValue(0,0));
		dtPie.addRows([
			['Operating Expense', view5.getValue(0,1)],
			['Funding Expense', view5.getValue(0,2)],
			['Provision Expense', view5.getValue(0,3)],
			['Yield Margin', view5.getValue(0,4)]
		]);
		perFormatter.format(dtPie,1);
		var chart5 = new google.visualization.ChartWrapper({
			containerId: 'chart5_div',
			chartType: 'PieChart',
			dataTable: dtPie,
			options:{
				title: 'Portfolio Yield ' + PYield_Selectedtext,
				pieSliceText:'value',
			}
		});
	} else {
		var chart5 = new google.visualization.ChartWrapper({
			containerId: 'chart5_div',
			chartType: 'ColumnChart',
			dataTable: view5,
			options:{
				title: 'Portfolio Yield ' + PYield_Selectedtext,
				isStacked: true,
				legend: {position: 'bottom'},
			}
		});
	}
	chart5.draw();
	var table2 = new google.visualization.ChartWrapper({
		containerId: 'table2_div',
		chartType: 'Table',
		dataTable: view5,
		options: {
			width:'100%',
		}
	});
	table2.draw();
}
function reDrawChart6(){
	// Selected option for Funding Cost Ratios
	var FC_SelectedID = document.getElementById("FundingCostRatios").selectedIndex;
	var FC_SelectedText = document.getElementById("FundingCostRatios").options[FC_SelectedID].text; 
	// Define Data Array for Chart
	var dataforChart6 = [ColHeader];
		for (var i=0; i<YearArr.length;i++) {
			var Rowi6 = [];
			for (var j=0; j<NameArr.length;j++) {
				var rIndx = filteredDT.getFilteredRows([{column:0,value: NameArr[j]},{column:2,value: YearArr[i]}]);
				if (rIndx[0]==null) {Rowi6.push(null);} else {
					Rowi6.push(filteredDT.getValue(rIndx[0],FC_SelectedID+65));
				};
			}
			Rowi6.unshift(YearArr[i].toFixed(0));
			dataforChart6[i+1] = Rowi6;
		}
	// Define DataTable for Chart
	var DTforChart6 = new google.visualization.arrayToDataTable(dataforChart6);
	// Formatting columns
	for (var i=1;i<=NameArr.length;i++) {
		perFormatter.format(DTforChart6,i);
	};
	// Draw Chart
	var chart6 = new google.visualization.ChartWrapper({
	containerId: 'chart6_div',
	chartType: 'LineChart',
	dataTable: DTforChart6,
	options: {
		title:FC_SelectedText,
		vAxis:{format:'percent'},
		pointSize:6,
		pointShape:'square',
		lineDashStyle:[4,4],
		legend: {position: 'bottom'},
	}
	});
	chart6.draw();
}
function reDrawChart7(){
	// Selected option for Leverage Ratios
	var Lev_SelectedID = document.getElementById("LevRatios").selectedIndex;
	var Lev_SelectedText = document.getElementById("LevRatios").options[Lev_SelectedID].text; 
	// Define Data Array for Chart
	var dataforChart7 = [ColHeader];
		for (var i=0; i<YearArr.length;i++) {
			var Rowi7 = [];
			for (var j=0; j<NameArr.length;j++) {
				var rIndx = filteredDT.getFilteredRows([{column:0,value: NameArr[j]},{column:2,value: YearArr[i]}]);
				if (rIndx[0]==null) {Rowi7.push(null);} else {
					Rowi7.push(filteredDT.getValue(rIndx[0],Lev_SelectedID+56));
				};
			}
			Rowi7.unshift(YearArr[i].toFixed(0));
			dataforChart7[i+1] = Rowi7;
		}
	// Define DataTable for Chart
	var DTforChart7 = new google.visualization.arrayToDataTable(dataforChart7);
	// Formatting columns
	for (var i=1;i<=NameArr.length;i++) {
		perFormatter.format(DTforChart7,i);
	};
	// Draw Chart
	var chart7 = new google.visualization.ChartWrapper({
	containerId: 'chart7_div',
	chartType: 'LineChart',
	dataTable: DTforChart7,
	options: {
		title:Lev_SelectedText,
		vAxis:{format:'percent'},
		pointSize:6,
		pointShape:'diamond',
		//lineDashStyle:[4,4],
		legend: {position: 'bottom'},
	}
	});
	chart7.draw();
}
function drawChart8() {
	//
	// Selected option for X-Axis
	var X_SelectedID = document.getElementById("X_Axis").selectedIndex;
	var X_SelectedText = document.getElementById("X_Axis").options[X_SelectedID].text;
	// Selected option for Y-Axis
	var Y_SelectedID = document.getElementById("Y_Axis").selectedIndex;
	var Y_SelectedText = document.getElementById("Y_Axis").options[Y_SelectedID].text;
	//
	var nCol = data.getNumberOfColumns();
	var nRow = data.getNumberOfRows();
	// Deep Copy of data
	data_ch = data.clone(); // DataTable that can be changed
	// Add a tooltip column for all names
	data_ch.addColumn('string','fortooltipoOfAlls');
	for (var r =0; r<nRow; r++) {
		// setcell for tooltip column
		data_ch.setCell(r, nCol, data.getValue(r,0)+' '+data.getValue(r,2)+
					' ('+numToStr(data.getValue(r,xID[X_SelectedID]),format_hAxis[X_SelectedID]) +
					' ; '+ numToStr(data.getValue(r,yID[Y_SelectedID]),format_vAxis[Y_SelectedID])+')');
	}
	//
	colToShow = [{sourceColumn: xID[X_SelectedID], type: 'number'}, //X-Axis
					 {sourceColumn: yID[Y_SelectedID],label:'Others',type: 'number'},
					 {sourceColumn: nCol, type: 'string',role:'tooltip'}]; // Y-Axis
	//
	nCol = nCol +1 ; // update number of columns
	// Setcell value and tooltip for each name
	for (var n=0;n<NameArr.length;n++) {
		data_ch.addColumn('number','temporary'); // nCol
		data_ch.addColumn('string','Fortooltip');//nCol+1	
		var EmRowsID = data.getFilteredRows([{column: 0, value:NameArr[n]},
											 {column: 2, minValue: YearArr[0], maxValue:YearArr[-1]}]);
		for (var i=0;i<EmRowsID.length;i++) {
			// setcell for value column
			data_ch.setCell(EmRowsID[i],nCol+2*n, data.getValue(EmRowsID[i],yID[Y_SelectedID]));
			// setcell for tooltip column
			data_ch.setCell(EmRowsID[i],nCol+2*n+1, data.getValue(EmRowsID[i],0)+' '+data.getValue(EmRowsID[i],2)+
						' ('+numToStr(data.getValue(EmRowsID[i],xID[X_SelectedID]),format_hAxis[X_SelectedID]) +
						' ; '+ numToStr(data.getValue(EmRowsID[i],yID[Y_SelectedID]),format_vAxis[Y_SelectedID])+')');
		}
		colToShow.push({sourceColumn: nCol+2*n, label:NameArr[n],type: 'number'});
		colToShow.push({sourceColumn: nCol+2*n+1, type: 'string',role:'tooltip'});
	}
	//
	isLess = false;
	redrawChart8();
	//
}
function redrawChart8(){
	// Selected option for X-Axis
	var X_SelectedID = document.getElementById("X_Axis").selectedIndex;
	var X_SelectedText = document.getElementById("X_Axis").options[X_SelectedID].text;
	// Selected option for Y-Axis
	var Y_SelectedID = document.getElementById("Y_Axis").selectedIndex;
	var Y_SelectedText = document.getElementById("Y_Axis").options[Y_SelectedID].text;
	//
	if (isLess) {
		colToShow.splice(0,1);
		colToShow.unshift({sourceColumn: xID[X_SelectedID],type: 'number'},{sourceColumn: yID[Y_SelectedID],label:'Others',type: 'number'},
							{sourceColumn: data.getNumberOfColumns(),type: 'string',role:'tooltip'});
		colToShow.unshift();
		isLess = false;
		document.getElementById("btn").innerHTML ="Show Less";
	} else	{
		colToShow.splice(0,3);
		colToShow.unshift(xID[X_SelectedID]);
		isLess = true;
		document.getElementById("btn").innerHTML ="Show More";
	}
	var Xlabel = data.getColumnLabel(xID[X_SelectedID]);
	var Ylabel = data.getColumnLabel(yID[Y_SelectedID]);
	var chart8 = new google.visualization.ScatterChart(document.getElementById('chart8_div'));
	//
    var option8 = {
        title: Xlabel + ' Vs ' + Ylabel,
        hAxis: {title: Xlabel,format:format_hAxis[X_SelectedID],gridlines:{count:12}},
        vAxis: {title: Ylabel,format:format_vAxis[Y_SelectedID],gridlines:{count:15}},
		//width:1000,
		//height:480 ,
        //legend: 'none',
		//annotations:{ textStyle:{auraColor: 'none', fontSize: 10}},
		legend: {position: 'bottom'},
    };
	dataView = new google.visualization.DataView(data_ch);
	dataView.setColumns(colToShow);
	chart8.draw(dataView,option8);
}
function numToStr(num,fo){
	if (num==null){return null;}
	if (fo=='decimal') {
		return '$'+num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");;
	} else {
		return (num*100).toFixed(1)+'%';
	}
} 
// 
$(window).load(function(){
/**
************************************************************
*************** THIS IS THE NAVIGATION CODE ****************
************************************************************
**/

$(function() {
    // Stick the #nav to the top of the window
    var nav = $('#nav');
    var navHomeY = nav.offset().top;
    var isFixed = false;
    var $w = $(window);
    $w.scroll(function() {
        var scrollTop = $w.scrollTop();
        var shouldBeFixed = scrollTop > navHomeY;
        if (shouldBeFixed && !isFixed) {
            nav.css({
                position: 'fixed',
                top: 0,
                left: nav.offset().left,
                width: nav.width()
            });
            isFixed = true;
        }
        else if (!shouldBeFixed && isFixed)
        {
            nav.css({
                position: 'static',
            });
            isFixed = false;
        }
    });
});

});   
	</script>
<style>
html {
	display: table;
	margin: auto;
}

body {
	display: table-cell;
	font-family: Georgia;
	width:900px;
	padding:10px;
}
#filterLicense_div{
	width:100%;
	padding:3px;
}
#filterName_div{
	width:100%;
	padding:3px;
}
#filterYear_div{
	width:100%;
	padding:3px;
}

#dashboard{
	background-color:rgb(234,242,248);
	padding-left:20px;
	border-radius: 15px;
}

footer {background-color:rgba(23,32,42,0.5);
		color:white;
		font-size:14px;
		margin-top:10px;
		padding:1px;
		text-align:center;
}
header {text-align: left;
		//background-color:#F5EEF8;
		border-radius: 5px;
		color:#273746;
		margin-bottom:10px;
		padding-left:2px;
		padding-bottom:10px;
		padding-top:10px;
		font-size:25px;
		font-weight:bold;
}
h3{
	//background-color:#F4F6F6;
	border-radius: 2px;
	//color:#2E86C1;
	color:#8E44AD;
	padding:4px;
	font-weight:bold;

}
#Setting{
	//background-color:rgb(212,230,241);
	//color:#4A235A;
	border-radius: 2px;
	padding:3px;
	//font-weight:bold;
}
option{
	padding:5px 0;
}
[id*="chart"] {
	height: 380px;
	width: 100%;
}
#chart8_div{
	height: 480px;
	width: 100%;
}
select{
	font-family: Georgia;
	font-size:100%;
}
<!-- *** NAVIGATION BAR STYLE *** -->
#navWrap {
    height: 40px;
	
}
#nav {
	padding: 0px;
	background: rgba(255,255,255,0.2);//white;//#566573;
	z-index:2;    
}
#nav ul {
   margin: 0;
   padding: 0;    
}
#nav li {
    float: left;
    list-style-type: none;
}
#nav li a {
    padding: 5px 5px;
    background-color: rgba(23,32,42,0.5);//rgba(80,179,244,0.5);////rgba(86,101,115,0.4);//#566573;
    margin: 0 3px 0 0;
	display:block;
	color: white;  
	text-decoration: none;
	//border-right:1px solid white;
}
#nav li a:hover {
	text-decoration: bold;
	background-color: rgba(23,32,42,0.8);//rgba(80,179,244,0.8);////rgba(39,55,70,0.7);//#273746;//#1a1aff;
	color:white;
}
br.clearLeft {
   clear: left;        
}​
<!-- **************************** -->
</style>
  </head>
  <body>
  <header>
	Cambodian Banks & MFIs Database Viewer Ver. 1.2
</header>
<h4><i> Last update: October 11, 2017 </i></h4>

<h3 id="Setting">Choose License and/or Institutions</h3>
 <div id="dashboard">
    <div id="filterLicense_div"></div>
	<div id="filterName_div"></div>
	<div id="filterYear_div"></div>
	<div id="table_div"></div>
</div>
</br>
<!-- *** NAVIGATION BAR *** -->
<div id="navWrap">
	<div id="nav">
		<ul>
			<li><a href="#KeyItemsInBSIS" class="smoothScroll">IS/BS Items</a></li>
			<li><a href="#Profitability" class="smoothScroll">Profitability</a></li>
			<li><a href="#DefaultRisk" class="smoothScroll">Portfolio Quality</a></li>
			<li><a href="#BreakdownPortYield" class="smoothScroll">PortYield Breakdown</a></li>
			<li><a href="#FundingCost" class="smoothScroll">Funding Cost</a></li>
			<li><a href="#Leverage" class="smoothScroll">Leverage</a></li>
			<li><a href="#ScatterChart" class="smoothScroll">Scatter Plot</a></li>
			<li><a href="#Setting" class="smoothScroll">Setting</a></li>
		</ul>    
		<br class="clearLeft" />
	</div>
</div>
<!-- ******************** -->
<div id="KeyItemsInBSIS"> 
	<!-- Key Items in Balance Sheet and Income Statement -->
	<h3 id="KeyBSIS">1. Key Items in Balance Sheet & Income Statement</h3>
	<form name="BSIS",id="BSIS">
		Select an item: 
		<select id="BSISitem" onchange="reDrawChart12()">
			<option value="Asset">Asset</option>
			<option value="Equity">Equity</option>
			<option value="GLP" selected>GLP</option>
			<option value="Net Loans">Net Loans</option>
			<option value="Customer Deposits">Customer Deposits</option>
			<option value="Interest Income">Interest Income</option>
			<option value="Net Interest Income">Net Int. Income</option>
			<option value="Risk-adj Net Interest Income">Risk-adj Net Int. Income</option>
			<option value="Operating Expense">Operating Expense</option>
			<option value="Profit Before Tax">PBT</option>
			<option value="NOPAT">NOPAT</option>
			<option value="Net Income">Net Income</option>
			<option value="Invested Capital">Invested Capital</option>
		</select>
	</form>
	<!-- <div id="table2_div"></div> -->
	<div id="chart1_div"></div>
	<div id="chart2_div"></div>
</div>
<!-- Profitability -->
<div id="Profitability"> 
	<h3 id="Profitability">2. Profitability Ratios</h3>
	<form name="Profit",id="Profit">
		Select an item: 
		<select id="ProfitabilityRatios" onchange="reDrawChart3()">
			<option value="Portfolio Yield">Portfolio Yield</option>
			<option value="NIM">NIM</option>
			<option value="ROA">ROA</option>
			<option value="ROE" selected>ROE</option>
			<option value="ROIC">ROIC</option>
		</select>
	</form>
	<div id="chart3_div"></div>
</div>
<!-- Default Risk -->
<div id="DefaultRisk"> 
	<h3 id="DefaultRiskRatios">3. Portfolio Quality</h3>
	<form name="Default",id="Default">
		Select an item: 
		<select id="DefaultRatios" onchange="reDrawChart4()">
			<option value="NPL Ratio" selected>NPL Ratio</option>
			<option value="Provision Ratio">Provision Ratio</option>
			<option value="Write-off Ratio">Write-off Ratio</option>
			<option value="Risk Coverage">Risk Coverage</option>
			<option value="Doubtful Loan Ratio">Doubtful Loan Ratio</option>
			<option value="Loss Loan Ratio">Loss Loan Ratio</option>
			</select>
	</form>
	<div id="chart4_div"></div>
</div>
<!-- Breakdown Portfolio Yield -->
<div id="BreakdownPortYield"> 
	<h3 id="PortfolioYield">4. Breakdown of Portfolio Yield</h3>
	<form>
		Select an item:
		<select id="PortYield" onchange="reDrawChart5()">
			<option>2017</option>
			</select>
	</form>
	<div id="chart5_div"></div>
	<div id="table2_div"></div>
	</br>
</div>
<!-- Funding Cost -->
<div id="FundingCost"> 
	<h3 id="FC">5. Funding Cost</h3>
	<form name="CoF",id="CoF">
		Select an item: 
		<select id="FundingCostRatios" onchange="reDrawChart6()">
			<option value="Cost of Debt" selected>Cost of Debt</option>
			<option value="Int. Expense/Ave.GLP">Funding Expense Ratio</option>
			<option value="Cost of Deposits">Cost of Deposits</option>
			</select>
	</form>
	<div id="chart6_div"></div>
</div>
<!-- Leverage -->
<div id="Leverage"> 
	<h3 id="LeverageRatios">6. Leverage</h3>
	<form name="Lev",id="Lev">
		Select an item: 
		<select id="LevRatios" onchange="reDrawChart7()">
			<option value="Debt/Invested Capital">Debt-to-Invested-Capital</option>
			<option value="D/E" selected>D/E</option>
			</select>
	</form>
	<div id="chart7_div"></div>
</div>
<!-- Loan Size -->
<div id="ScatterChart"> 
	<h3>7. Scatter Chart</h3>
	<!-- -->
	<form>
		X-Axis:
		<select id="X_Axis" onchange="drawChart8()">
			<option value="Loan Size">Loan Size</option>
			<option value="Portfolio Yield">Portfolio Yield</option>
			<option value="Operating Exp./Av.GLP" selected>Operating Exp./Av.GLP</option>
		</select>
		 Y-Axis:
		<select id="Y_Axis" onchange="drawChart8()">
			<option value="Portfolio Yield" selected>Portfolio Yield</option>
			<option value="Operating Exp./Av.GLP">Operating Exp./Av.GLP</option>
			<option value="ROE">ROE</option>
			<option value="ROIC">ROIC</option>
		</select>
	</form>
	<div id="chart8_div"></div>
	</br>
	<div align="right"><button type="button" onclick="redrawChart8()" id="btn"></button></div>
</div>
<!-- About Database -->
<div id="DBinfo"> 
	<h3>Database Info</h3>
	<p>Database info will be provided later!</p>
</div>
<footer>Copyright &copy; 2017, Yuanta Securities (Cambodia) Plc.</footer>
  </body>
</html>
